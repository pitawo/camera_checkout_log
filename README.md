# LENS-SHARE Pro - カメラ貸出管理システム

備品カメラの貸出・返却を管理するWebアプリケーションです。

---

## 機能一覧

### 貸出申請
- カメラを選択して貸出申請
- 氏名、貸出期間（月/日形式）、利用目的を入力
- カレンダーからの日付選択にも対応

### リアルタイム稼働状況
- 全カメラの状態を一覧表示
- 利用可能 / 貸出中のステータス表示
- 貸出中のカメラは借用者・期間・目的を表示
- ワンクリックで返却処理

### 機材マスター設定
- 機材の追加
- 機材名の変更
- 機材の削除（貸出中の機材は削除不可）

### 自動データ保存
- 貸出・返却・設定変更時に自動保存
- 毎日 20:59 に自動保存（シャットダウン対策）
- 毎日 6:59 に自動保存（起動時バックアップ）
- アプリ終了時に自動保存
- 起動時に前回データを自動読み込み

---

## ファイル構成

```
カメラ台帳/
├── app.py              # メインアプリケーション
├── requirements.txt    # 必要なパッケージ一覧
├── run.bat             # 起動用バッチファイル
├── camera_data.json    # データ保存ファイル（自動生成）
├── README.md           # このファイル
└── templates/
    └── index.html      # 画面テンプレート
```

---

## セットアップ手順

### 1. 必要なパッケージをインストール

```bash
pip install -r requirements.txt
```

または個別にインストール：

```bash
pip install flask apscheduler
```

### 2. アプリケーションを起動

**方法A: バッチファイルから起動**
```
run.bat をダブルクリック
```

**方法B: コマンドラインから起動**
```bash
python app.py
```

### 3. ブラウザでアクセス

```
http://127.0.0.1:5000
```

---

## 使い方

### カメラを借りる

1. 左側の「貸出申請」フォームを使用
2. カメラをプルダウンから選択
3. 氏名を入力
4. 貸出期間を入力（直接入力 or カレンダーアイコンをクリック）
5. 利用目的を入力（任意）
6. 「借りる」ボタンをクリック

### カメラを返却する

1. 右側のカード一覧から対象のカメラを探す
2. 「返却完了」ボタンをクリック

### 機材を追加・編集・削除する

1. 右上の「設定」ボタンをクリック
2. **追加**: 機材名を入力して「+」ボタン
3. **編集・削除**: 一覧から機材をクリック → アクションパネルが表示
   - 「名前を変更」→ 新しい名前を入力して「変更」
   - 「削除」→ 確認後に削除（貸出中は削除不可）

---

## AWS運用について

### 自動保存スケジュール

| 時刻 | 動作 |
|------|------|
| 6:59 | 朝のバックアップ保存 |
| 20:59 | シャットダウン前の保存 |

### データ永続化

- データは `camera_data.json` に保存されます
- サーバー再起動後も前回の状態から継続できます
- EBSボリュームなど永続ストレージに配置してください

---

## 管理用エンドポイント

| URL | 説明 |
|-----|------|
| `/api/save` | 手動でデータを保存 |

---

## トラブルシューティング

### データが消えた場合
- `camera_data.json` が存在するか確認
- ファイルが破損している場合は削除すると初期データで起動します

### スケジューラーが動作しない場合
- `use_reloader=False` が設定されているか確認
- コンソールにエラーが出ていないか確認

---

## 技術仕様

- **フレームワーク**: Flask
- **スケジューラー**: APScheduler
- **フロントエンド**: Tailwind CSS, Font Awesome
- **データ形式**: JSON

---

## バージョン

- v1.0.0 - 初回リリース
